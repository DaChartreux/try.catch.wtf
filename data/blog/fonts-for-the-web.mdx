---
title: Fonts for the web
heroImageName: aWZJCO4Rs1Y
heroCreditUserProfile: Greg Rosenke
heroCreditUserProfileUrl: https://unsplash.com/@greg_rosenke?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText
heroCreditSource: Unsplash
createdAt: 17 Oct 2021
---

When I was building this blog, finding a good font was a pain in the butt. After several weeks, I settled with [Jost\*](https://indestructibletype.com/Jost.html) font only to find realize that my lighthouse performance score dipped üòê. Thats when I realized that fonts can impact performance.

In this post, I'm going to share some ü™Ñ woodoo to uplift the lighthouse performance score.

# Potential impacts of fonts

- ### Delayed text rendering

  If a web font has not loaded, it can delay text rendering. Which results in delayed First Contentful Paint (FCP) or delayed Largest Contentful Paint (LCP).

- ### Layout shifts
  When fonts are loaded and swapped, they can cause layout shifts. These layout shifts occur when a web font and its fallback font take up different amounts of space on the page.

Umm... What can we do to fix these issues ü§î?

# Font loading

Let's see how we can load and use a font.

```css
@font-face {
  font-family: Jost;
  font-weight: 400;
  font-display: swap;
  font-style: normal;
  src: url("/fonts/Jost/Jost-400.woff2") format("woff2");
}

.custom-font {
  font-family: Jost;
}
```

This specifies that a font located at `/fonts/Jost/Jost-400.woff2`, of `woff2` type, with `400` weight, and `normal` style is referenced as `Jost`. Now we can use our font anywhere by setting `font-family: Jost;`. Browsers download fonts only if a styling on the page references them. In this case, the browser will download 'Jost' font only if the page had an element with class `.custom-font`.

Sometimes, the absence of fonts can make your page unusable. It might be a no-brainer to load them asap because you WILL use them. We can `preload` fonts by adding a `<link>` in the `<head>`. This way it will be downloaded at the earliest.

```html
<head>
  <link
    rel="preload"
    href="/fonts/Jost/Jost-400.woff2"
    as="font"
    type="font/woff2"
    crossorigin
  />
</head>
```

But this comes at a cost üòî. `preload`ing fonts super early might obstruct other critical resources for the page. If at-all you end up `preload`ing fonts, make sure your longest critical chain is short.

When loading fonts from a 3rd party origin, you can `preconnect` to establish early connection(s). Below is an example with Google Fonts.

```html
<head>
  <!-- preconnect origin serving stylesheets -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />

  <!-- preconnect origin serving fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

  <!-- loading stylesheets -->
  <link
    href="https://fonts.googleapis.com/css2?family=Jost&display=swap"
    rel="stylesheet"
  />
</head>
```

> `preconnect` for fonts needs a `crossorigin` attribute because unlike stylesheets, font files are served over [CORS connection](https://www.w3.org/TR/css-fonts-3/#font-fetching-requirements).

<div style={{ display: "grid", maxWidth: "100%" }}>
  <Image
    src="/img/blog/fonts-for-the-web/no-prefetch.png"
    width={677}
    height={381}
    quality={70}
    layout="intrinsic"
    objectFit="contain"
  />
</div>

<div style={{ display: "grid", maxWidth: "100%" }}>
  <Image
    src="/img/blog/fonts-for-the-web/prefetch.png"
    width={677}
    height={381}
    quality={70}
    layout="intrinsic"
    objectFit="contain"
  />
</div>

If you are serving the fonts yourself,

# Font delivery

We are ready to load our fonts in the web page. But, how do we deliver them optimally? If you are using a 3rd party service, there is nothing much for you to do in this section. Services like Google Fonts already optimize fonts for fast serving.

If you are serving the fonts yourself, it is better to serve them over a CDN via HTTP/2 which results in faster delivery to clients. You can perform font-subsetting and WOFF2 compression to reduce the size of font files as well.

## Font subsetting

Font subsetting is the process of taking a font file and reducing the number of characters. For example, let's say you have a font with japanese characters like `Êúà`. You are serving a page which is in english. It is highly unlikely you'd ever use these japanese characters. So you can subset your font to contain only simple latin characters.

This will naturally reduce the size of the font file. Use tools like [glyphhanger](https://github.com/zachleat/glyphhanger) or [subfont](https://github.com/Munter/subfont) to subset fonts.

Let's subset `Jost-400-Book.ttf`. You can download it from [here](https://indestructibletype.com/Jost.html).

```shell
# install glyphhanger
npm i -g glyphhanger

# install fonttools
pip install fonttools

# subsetting Jost-400-Book.ttf font to Latin charset
glyphhanger --LATIN --subset=Jost-400-Book.ttf
```

This results in a TTF file (`Jost-400-Book-subset.ttf`) of size `40.5 kb` from `88.7 kb`! Already a reduction of 54%!

> There are online tools like [Charset checker](https://www.alphabet-type.com/tools/charset-checker) to check the charset of fonts. You can use this to verify if subsetted font match your required charset or not.

## WOFF2 compression

WOFF2 is a compressed font format that can compress a TTF font.

Let's use our subset font (`Jost-400-Book-subset.ttf`) and compress it to woff2.

```shell
# clone woff2
git clone --recursive https://github.com/google/woff2.git

# enter into the cloned repo
cd woff2

# build
make clean all

# convert the font
./woff2_compress ~/Jost-400-Book-subset.ttf
```

This results in a woff2 file (`Jost-400-Book-subset.woff2`) of size `15.3 kb` from `40.5 kb`! A whopping decrease of 62% (and 82% decrease when compared to the original font file `Jost-400-Book.ttf`)!
