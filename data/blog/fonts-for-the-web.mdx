---
title: Fonts for the web
heroImageName: aWZJCO4Rs1Y
heroCreditUserProfile: Greg Rosenke
heroCreditUserProfileUrl: https://unsplash.com/@greg_rosenke?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText
heroCreditSource: Unsplash
createdAt: 17 Oct 2021
---

When I was building this blog, finding a good font was a pain in the butt. After several weeks, I settled with [Jost\*](https://indestructibletype.com/Jost.html) font only to find realize that my lighthouse performance score dipped üòê. Thats when I realized that fonts can impact performance.

In this post, I'm going to share some ü™Ñ woodoo to uplift the lighthouse performance score.

# Potential impacts of fonts

- ### Delayed text rendering

  If a web font has not loaded, it can delay text rendering. Which results in delayed First Contentful Paint (FCP) or delayed Largest Contentful Paint (LCP).

- ### Layout shifts
  When fonts are loaded and swapped, they can cause layout shifts. These layout shifts occur when a web font and its fallback font take up different amounts of space on the page.

Umm... What can we do to fix these ü§îs?

# Font loading

We can use `@font-face` CSS rule to specify a custom font.

```css
@font-face {
  font-family: Jost;
  font-weight: 400;
  font-display: swap;
  font-style: normal;
  src: url("/fonts/Jost/Jost-400.woff2") format("woff2");
}
```

This specifies that a font located at `/fonts/Jost/Jost-400.woff2` of type `woff2`, will be referenced as `Jost`, having a weight of `400`, and `normal` style. Another thing to note is that the browser will not download the fonts until it is referenced by styling that is used on the page.

Fonts are essential resources, without which users might be unable to view page content. So it seems obvious to load them as early as possible.

When loading fonts from a 3rd party origin (like [Google Fonts](https://fonts.google.com/)), you can `preconnect` to establish early connection(s). First load the fonts stylesheet. To `preconnect` the connection for downloading the fonts, add `crossorigin` attribute.

```html
<head>
  <link rel="preconnect" href="https://fonts.example.com" />
  <link rel="preconnect" href="https://fonts.example.com" crossorigin />
</head>
```

> Unlike stylesheets, font files are served over [CORS connection](https://www.w3.org/TR/css-fonts-3/#font-fetching-requirements).

These `<link>` tags should be placed as early in the document as possible.

<div style={{ display: "grid", maxWidth: "100%" }}>
  <Image
    src="/img/blog/fonts-for-the-web/no-prefetch.png"
    width={677}
    height={381}
    quality={70}
    layout="intrinsic"
    objectFit="contain"
  />
</div>

<div style={{ display: "grid", maxWidth: "100%" }}>
  <Image
    src="/img/blog/fonts-for-the-web/prefetch.png"
    width={677}
    height={381}
    quality={70}
    layout="intrinsic"
    objectFit="contain"
  />
</div>

If you are serving the fonts yourself, you can `preload` the fonts in `<head>`. It will load fonts early, but it will slow down the loading of other resources. `preload` also ignores `unicode-range` when loading fonts. It is most useful to load single font files.

```html
<head>
  <link
    rel="preload"
    href="/fonts/Jost/Jost-400.woff2"
    as="font"
    type="font/woff2"
    crossorigin
  />
</head>
```

# Font delivery

When serving fonts yourself, it is better to serve them over a CDN via HTTP/2. You can perform font-subsetting and WOFF2 compression to reduce the size of font files.

## Font subsetting

Font subsetting is the process of taking a font file and creating smaller files with fewer characters (or OpenType features). This will naturally reduce the size of the font file. You can use tools like [glyphhanger](https://github.com/zachleat/glyphhanger) or [subfont](https://github.com/Munter/subfont).

Let's subset Jost-VF.ttf (the font used in this site üò≥).

```shell
# install glyphhanger
npm i -g glyphhanger

# install fonttools
pip install fonttools

# subsetting Jost-VF font to Latin charset
glyphhanger --LATIN --subset=Jost-VF.ttf
```

## WOFF2 compression

WOFF2 is a compressed font format that can compress a TTF font up to 30% (on average).

And now let's compress our font.

```shell
# clone woff2
git clone --recursive https://github.com/google/woff2.git

# enter into the cloned repo
cd woff2

# build
make clean all

# convert the font
./woff2_compress ~/Jost-VF.ttf
```
